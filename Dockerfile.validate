FROM python:3.11-alpine

# Install protobuf compiler and yamllint
RUN apk add --no-cache protobuf && \
    pip3 install --no-cache-dir yamllint protobuf pyyaml

WORKDIR /workspace

# Default command runs all validations
CMD ["sh", "-c", "\
    echo 'Running YAML linting...' && \
    yamllint generated/yaml/ && \
    yamllint examples/ && \
    echo '' && \
    echo 'Validating example files against protobuf schema...' && \
    python3 tools/validate-examples.py \
"]
