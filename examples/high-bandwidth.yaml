# High-Bandwidth Configuration for Camera-Heavy Robots
#
# Optimized for robots with multiple cameras or high-frequency sensors.
# Aggressive sampling reduces trace and storage overhead while maintaining
# visibility into critical control paths.

schema_version: "0.4.15"

tracing:
  enabled: true
  underlying_rmw: "rmw_fastrtps_cpp"

  # Aggressive trace sampling for high-bandwidth topics
  trace_rate:
    default_rate: 1.0
    overrides:
      # Camera images: trace 1% (high bandwidth, low value per trace)
      - pattern: "^/camera/.*/image_raw$"
        rate: 0.01
      - pattern: "^/camera/.*/compressed$"
        rate: 0.01

      # Depth images: trace 1%
      - pattern: "^/camera/.*/depth$"
        rate: 0.01

      # Point clouds: trace 1%
      - pattern: "^/camera/.*/points$"
        rate: 0.01

      # LiDAR scans: trace 10%
      - pattern: "^/scan$"
        rate: 0.1

      # Control commands: always trace (critical path)
      - pattern: "^/cmd_vel$"
        rate: 1.0

      # Diagnostics: always trace
      - pattern: "^/diagnostics$"
        rate: 1.0

  correlation:
    timestamp_tolerance_ns: 10000000
    window_secs: 30
    hash_enabled: true

  clock:
    max_acceptable_skew_ns: 10000000
    check_interval_secs: 60

  diagnostics:
    enabled: true
    interval_secs: 10

  performance:
    queue_size: 2048  # Increased for high-frequency topics
    failure_threshold: 100

subscriptions:
  default_strategy: "adaptive"

  adaptive:
    # More aggressive downsampling for high-bandwidth sensors
    high_bandwidth_threshold_bps: 1048576
    high_bandwidth_target_hz: 1.0  # Reduced from 2.0
    low_bandwidth_threshold_bps: 10240
    low_bandwidth_strategy: "on_change"
    medium_bandwidth_target_hz: 5.0  # Reduced from 10.0

metrics:
  enabled: true
  collection_interval_secs: 10

tf:
  enabled: true
  snapshot_hz: 10.0
